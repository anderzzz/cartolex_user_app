<!-- Workflow Configuration Expansion Panel -->
<div id="config-{{ workflow_name }}" class="border-t esevioz-border-dominant px-6 py-4 esevioz-bg-accent">
    <form hx-put="{{ url_for('workflows.update_workflow_config', workflow_name=workflow_name) }}"
          hx-target="#config-save-result-{{ workflow_name }}"
          hx-swap="innerHTML"
          class="space-y-6">
        
        <!-- Configuration Header -->
        <div class="flex items-center justify-between">
            <div>
                <h4 class="text-lg font-medium esevioz-text">Workflow Configuration</h4>
                <p class="text-sm esevioz-text opacity-75">Source: {{ config_source }}</p>
            </div>
            <button type="button" 
                    hx-get="{{ url_for('workflows.list_workflows') }}"
                    hx-target="#workflow-{{ workflow_name }}-config"
                    hx-swap="outerHTML"
                    class="text-sm esevioz-text opacity-75 hover:opacity-100">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
        </div>

        <!-- Workflow Basic Info (Read-only) -->
        {% if config.description %}
        <div>
            <label class="block text-sm font-medium esevioz-text mb-2">Description</label>
            <div class="p-3 esevioz-bg rounded-md border esevioz-border-dominant">
                <p class="text-sm esevioz-text opacity-75">{{ config.description }}</p>
            </div>
        </div>
        {% endif %}

        <!-- Workflow Launcher Section -->
        {% if config.workflow_launcher %}
        <div class="space-y-4">
            <h5 class="text-md font-medium esevioz-text border-b esevioz-border-dominant pb-2">Launcher Configuration</h5>
            
            <!-- Launcher Name (Read-only) -->
            <div>
                <label class="block text-sm font-medium esevioz-text mb-2">Launcher Type</label>
                <div class="p-3 esevioz-bg rounded-md border esevioz-border-dominant">
                    <p class="text-sm esevioz-text opacity-75">{{ config.workflow_launcher.launcher_name or 'Not specified' }}</p>
                </div>
            </div>

            <!-- Launcher Parameters (Editable) -->
            {% if config.workflow_launcher.launcher_params %}
            <div>
                <label class="block text-sm font-medium esevioz-text mb-3">Launcher Parameters</label>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    {% for param_name, param_value in config.workflow_launcher.launcher_params.items() %}
                    <div>
                        <label for="launcher_param_{{ param_name }}" class="block text-sm font-medium esevioz-text">
                            {{ param_name.replace('_', ' ').title() }}
                        </label>
                        <input type="text" 
                               id="launcher_param_{{ param_name }}"
                               name="launcher_param_{{ param_name }}"
                               value="{{ param_value }}"
                               class="mt-1 block w-full esevioz-input rounded-md shadow-sm sm:text-sm">
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}
        </div>
        {% endif %}

        <!-- Workflow Lander Section -->
        {% if config.workflow_lander %}
        <div class="space-y-4">
            <h5 class="text-md font-medium esevioz-text border-b esevioz-border-dominant pb-2">Lander Configuration</h5>
            
            <!-- Lander Name (Read-only) -->
            <div>
                <label class="block text-sm font-medium esevioz-text mb-2">Lander Type</label>
                <div class="p-3 esevioz-bg rounded-md border esevioz-border-dominant">
                    <p class="text-sm esevioz-text opacity-75">{{ config.workflow_lander.lander_name or 'Not specified' }}</p>
                </div>
            </div>

            <!-- Lander Parameters (Editable) -->
            {% if config.workflow_lander.lander_params %}
            <div>
                <label class="block text-sm font-medium esevioz-text mb-3">Lander Parameters</label>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    {% for param_name, param_value in config.workflow_lander.lander_params.items() %}
                    <div>
                        <label for="lander_param_{{ param_name }}" class="block text-sm font-medium esevioz-text">
                            {{ param_name.replace('_', ' ').title() }}
                        </label>
                        <input type="text" 
                               id="lander_param_{{ param_name }}"
                               name="lander_param_{{ param_name }}"
                               value="{{ param_value }}"
                               class="mt-1 block w-full esevioz-input rounded-md shadow-sm sm:text-sm">
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}
        </div>
        {% endif %}

        <!-- Action Buttons -->
        <div class="flex justify-end space-x-3 pt-4 border-t esevioz-border-dominant">
            <button type="button" 
                    hx-get="{{ url_for('workflows.list_workflows') }}"
                    hx-target="#workflow-{{ workflow_name }}-config"
                    hx-swap="outerHTML"
                    class="px-4 py-2 text-sm font-medium rounded-md esevioz-btn-secondary">
                Cancel
            </button>
            <button type="submit" 
                    class="px-4 py-2 text-sm font-medium rounded-md esevioz-btn-primary htmx-indicator">
                <svg class="animate-spin -ml-1 mr-2 h-4 w-4 text-current hidden" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                Save Configuration
            </button>
        </div>

        <!-- Save Result Area -->
        <div id="config-save-result-{{ workflow_name }}" class="mt-4"></div>
    </form>
</div>