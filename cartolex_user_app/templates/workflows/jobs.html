<!-- Jobs page using shared constants -->
{% extends "base.html" %}

{% block content %}
<div class="px-4 py-6 sm:px-0">
    <!-- Status filter dropdown using shared constants -->
    <div class="mb-6">
        <select id="status-filter" onchange="filterJobs()" class="border-gray-300 rounded-md">
            <option value="">All Statuses</option>
            {% for status in all_statuses %}
                <option value="{{ status }}" {% if current_filter == status %}selected{% endif %}>
                    {{ status | title }}
                </option>
            {% endfor %}
        </select>
    </div>

    <!-- Jobs table -->
    <div class="bg-white shadow rounded-lg overflow-hidden">
        {% if jobs %}
            <table class="min-w-full divide-y divide-gray-200">
                <tbody class="bg-white divide-y divide-gray-200">
                    {% for job in jobs %}
                        <tr>
                            <td class="px-6 py-4">
                                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium {{ job.status | job_status_class }}">
                                    {{ job.status | title }}
                                </span>
                            </td>
                            <td class="px-6 py-4">
                                {% if job.status | is_active %}
                                    <!-- Auto-update active jobs -->
                                    <div hx-get="/workflows/jobs/{{ job.id }}/status"
                                         hx-trigger="every 3s"
                                         hx-swap="outerHTML">
                                        {{ job.status }}
                                    </div>
                                {% else %}
                                    {{ job.status }}
                                {% endif %}
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% endif %}
    </div>
</div>
{% endblock %}